# 索引优化及失效
![](/about/media/pic/索引优化.png)

## explain 执行计划详解
![](/about/media/pic/explain详解.png)
  - **各属性含义**
    
    1. id 查询的序列号
    2. select_type: 查询的类型，主要是区别普通查询和联合查询、子查询之类的复杂查询 
```
  [1]SIMPLE：查询中不包含子查询或者UNION
  [2]查询中若包含任何复杂的子部分，最外层查询则被标记为：PRIMARY
  [3]在SELECT或WHERE列表中包含了子查询，该子查询被标记为：SUBQUERY
``` 
    3. table:输出的行所引用的表
    4. type:访问类型

![](/about/media/pic/explain-type.png)

```
   从左至右，性能由差到好;

[1]ALL: 扫描全表

[2]index: 扫描全部索引树

[3]range: 扫描部分索引，索引范围扫描，对索引的扫描开始于某一点，返回匹配值域的行，常见于between、<、>等的查询

[4]ref: 使用非唯一索引或非唯一索引前缀进行的查找
(eq_ref和const的区别)

[5]eq_ref：唯一性索引扫描，对于每个索引键，表中只有一条记录与之匹配。常见于主键或唯一索引扫描

[6]const, system: 单表中最多有一个匹配行，查询起来非常迅速，例如根据主键或唯一索引查询。system是const类型的特例，当查询的表只有一行的情况下， 使用system。

[7]NULL: 不用访问表或者索引，直接就能得到结果;
如select 1 from test where 1

```
 5. possible_keys: 表示查询时可能使用的索引。如果是空的，没有相关的索引。这时要提高性能，可通过检验WHERE子句，看是否引用某些字段，或者检查字段不是适合索引
 6. key: 显示MySQL实际决定使用的索引。如果没有索引被选择，是NULL
 7. key_len: 使用到索引字段的长度
 ```
       注：key_len显示的值为索引字段的最大可能长度，并非实际使用长度，即key_len是根据表定义计算而得，不是通过表内检索出的。
 ```
 8.  ref: 显示哪个字段或常数与key一起被使用
 9.    rows: 这个数表示mysql要遍历多少数据才能找到，表示MySQL根据表统计信息及索引选用情况，估算的找到所需的记录所需要读取的行数，在innodb上可能是不准确的
 10. Extra: 执行情况的说明和描述。包含不适合在其他列中显示但十分重要的额外信息。
 ```
   1. Using index：表示使用索引，如果只有 Using index，说明他没有查询到数据表，只用索引表就完成了这个查询，这个叫覆盖索引。
   2. Using where：表示条件查询，如果不读取表的所有数据，或不是仅仅通过索引就可以获取所有需要的数据，则会出现 Using where。
 ```

